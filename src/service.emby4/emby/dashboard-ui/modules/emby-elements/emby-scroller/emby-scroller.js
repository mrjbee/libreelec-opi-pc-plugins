define(["scroller","dom","layoutManager","inputManager","focusManager","browser"],function(scroller,dom,layoutManager,inputManager,focusManager,browser){"use strict";function onInit(){var elem=this;elem.hasInit||(elem.hasInit=!0,this.classList.add("emby-scroller"))}function initCenterFocus(elem,scrollerInstance){dom.addEventListener(elem,"focus",function(e){var focused=focusManager.focusableParent(e.target);focused&&scrollerInstance.toCenter(focused)},{capture:!0,passive:!0})}function _scrollToBeginning(){this.scroller&&this.scroller.slideTo(0,!0)}function _toStart(elem,immediate){this.scroller&&this.scroller.toStart(elem,immediate)}function _toCenter(elem,immediate){this.scroller&&this.scroller.toCenter(elem,immediate)}function _scrollToPosition(pos,immediate){this.scroller&&this.scroller.slideTo(pos,immediate)}function _getScrollPosition(){if(this.scroller)return this.scroller.getScrollPosition()}function _getScrollSize(){if(this.scroller)return this.scroller.getScrollSize()}function _getScrollEventName(){if(this.scroller)return this.scroller.getScrollEventName()}function _getScrollSlider(){if(this.scroller)return this.scroller.getScrollSlider()}function _addScrollEventListener(fn,options){this.scroller&&dom.addEventListener(this.scroller.getScrollFrame(),this.scroller.getScrollEventName(),fn,options)}function _removeScrollEventListener(fn,options){this.scroller&&dom.removeEventListener(this.scroller.getScrollFrame(),this.scroller.getScrollEventName(),fn,options)}function onInputCommand(e){var cmd=e.detail.command;"end"===cmd?(focusManager.focusLast(this,navSelector),e.preventDefault(),e.stopPropagation()):"pageup"===cmd?(focusManager.moveFocus(e.target,this,navSelector,-12),e.preventDefault(),e.stopPropagation()):"pagedown"===cmd&&(focusManager.moveFocus(e.target,this,navSelector,12),e.preventDefault(),e.stopPropagation())}function initHeadroom(elem){require(["headroom"],function(Headroom){var headroom=new Headroom([],{scroller:elem});headroom.init(),headroom.add(document.querySelector(".skinHeader")),elem.headroom=headroom})}function _connectedCallback(){this.getAttribute("data-navcommands")&&inputManager.on(this,onInputCommand);var horizontal="false"!==this.getAttribute("data-horizontal"),slider=this.querySelector(".scrollSlider");horizontal&&(slider.style["white-space"]="nowrap");var bindHeader="true"===this.getAttribute("data-bindheader"),scrollFrame=this,enableScrollButtons=layoutManager.desktop&&horizontal&&"false"!==this.getAttribute("data-scrollbuttons"),options={horizontal:horizontal,mouseDragging:1,mouseWheel:"false"!==this.getAttribute("data-mousewheel"),touchDragging:1,slidee:slider,scrollBy:200,speed:horizontal?270:240,elasticBounds:1,dragHandle:1,scrollWidth:"auto"===this.getAttribute("data-scrollsize")?null:5e6,autoImmediate:!0,skipSlideToWhenVisible:"true"===this.getAttribute("data-skipfocuswhenvisible"),dispatchScrollEvent:enableScrollButtons||bindHeader||"true"===this.getAttribute("data-scrollevent"),hideScrollbar:enableScrollButtons||"true"===this.getAttribute("data-hidescrollbar"),allowNativeSmoothScroll:"true"===this.getAttribute("data-allownativesmoothscroll")&&!enableScrollButtons,allowNativeScroll:!enableScrollButtons,forceHideScrollbars:enableScrollButtons,requireAnimation:enableScrollButtons&&browser.edge};this.scroller=new scroller(scrollFrame,options),this.scroller.init(),layoutManager.tv&&this.getAttribute("data-centerfocus")&&initCenterFocus(this,this.scroller),bindHeader&&initHeadroom(this),enableScrollButtons&&loadScrollButtons(this)}function loadScrollButtons(scroller){require(["emby-scrollbuttons"],function(){scroller.insertAdjacentHTML("beforeend",'<div is="emby-scrollbuttons"></div>')})}function _pause(){var headroom=this.headroom;headroom&&headroom.pause()}function _resume(){var headroom=this.headroom;headroom&&headroom.resume()}function _disconnectedCallback(){this.getAttribute("data-navcommands")&&inputManager.off(this,onInputCommand);var headroom=this.headroom;headroom&&(headroom.destroy(),this.headroom=null);var scrollerInstance=this.scroller;scrollerInstance&&(scrollerInstance.destroy(),this.scroller=null)}var navSelector=".card,.listItem";if(window.customElements){var EmbyScroller=function(_HTMLDivElement){function EmbyScroller(){var _this;babelHelpers.classCallCheck(this,EmbyScroller);var self=_this=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(EmbyScroller).call(this));return onInit.call(self),babelHelpers.possibleConstructorReturn(_this,self)}return babelHelpers.inherits(EmbyScroller,_HTMLDivElement),babelHelpers.createClass(EmbyScroller,[{key:"connectedCallback",value:function(){onInit.call(this),_connectedCallback.call(this)}},{key:"disconnectedCallback",value:function(){_disconnectedCallback.call(this)}},{key:"pause",value:function(){return _pause.apply(this,arguments)}},{key:"resume",value:function(){return _resume.apply(this,arguments)}},{key:"getScrollSize",value:function(){return _getScrollSize.call(this)}},{key:"getScrollPosition",value:function(){return _getScrollPosition.call(this)}},{key:"getScrollEventName",value:function(){return _getScrollEventName.call(this)}},{key:"getScrollSlider",value:function(){return _getScrollSlider.call(this)}},{key:"scrollToBeginning",value:function(){_scrollToBeginning.call(this)}},{key:"toStart",value:function(){_toStart.apply(this,arguments)}},{key:"toCenter",value:function(){_toCenter.apply(this,arguments)}},{key:"scrollToPosition",value:function(){_scrollToPosition.apply(this,arguments)}},{key:"addScrollEventListener",value:function(){_addScrollEventListener.apply(this,arguments)}},{key:"removeScrollEventListener",value:function(){_removeScrollEventListener.apply(this,arguments)}}]),EmbyScroller}(babelHelpers.wrapNativeSuper(HTMLDivElement));customElements.define("emby-scroller",EmbyScroller,{extends:"div"})}else if(document.registerElement){var ScrollerProtoType=Object.create(HTMLDivElement.prototype);ScrollerProtoType.createdCallback=onInit,ScrollerProtoType.attachedCallback=_connectedCallback,ScrollerProtoType.detachedCallback=_disconnectedCallback,ScrollerProtoType.getScrollSize=_getScrollSize,ScrollerProtoType.getScrollPosition=_getScrollPosition,ScrollerProtoType.getScrollEventName=_getScrollEventName,ScrollerProtoType.getScrollSlider=_getScrollSlider,ScrollerProtoType.scrollToBeginning=_scrollToBeginning,ScrollerProtoType.toStart=_toStart,ScrollerProtoType.toCenter=_toCenter,ScrollerProtoType.scrollToPosition=_scrollToPosition,ScrollerProtoType.addScrollEventListener=_addScrollEventListener,ScrollerProtoType.removeScrollEventListener=_removeScrollEventListener,document.registerElement("emby-scroller",{prototype:ScrollerProtoType,extends:"div"})}});